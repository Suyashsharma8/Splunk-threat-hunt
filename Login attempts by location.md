This SPL command is to get user attemps by location and separate the results based on date and then dedup. Using dedup with the consecutive=true option on the location, time, and ipAddress fields. This means that only consecutive events with the same location, time, and IP address are considered duplicates and removed from the results. This can significantly reduce the number of events, especially if there are many repeated sign-ins from the same location and IP address within short periods of time. If you’re interested in every single sign-in event, then the second query without dedup would be more appropriate. But if you’re only interested in distinct sign-in events from different locations, times, and IP addresses, then the first query with dedup would be more suitable. Remember, dedup doesn’t modify the original data, it only affects the search results. So you can experiment with different queries and options to find what works best for your needs. The eval command is used to create a new field or reassign a value to an existing field. Here, it’s creating a new field called time and assigning it the value of _time (which is a default field in Splunk representing the timestamp of the event) formatted as a string in the "YYYY-MM-DD" format. The strftime function is used to convert a time value from epoch time to a string representing the time.
```spl
index=cloud_azure_raw sourcetype="azure:aad:signin" <insert user's email address here> 
|eval time=strftime(_time, "%Y-%m-%d") 
|eval timeComp=strftime(_time, "%Y-%m-%d %H:%M")
|eval location= 'location.countryOrRegion'. " - " .'location.city' 
|dedup consecutive=true location time ipAddress 
| table timeComp,location,action,appDisplayName,ipAddress,deviceDetail.browser, deviceDetail.operatingSystem,deviceDetail.displayName
```
